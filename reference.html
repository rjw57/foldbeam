
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Reference &mdash; The foldbeam manual</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2012-08-10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="The foldbeam manual" href="index.html" />
    <link rel="next" title="Design notes" href="design.html" />
    <link rel="prev" title="The Foldbeam GIS System" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="design.html" title="Design notes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The Foldbeam GIS System"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">The foldbeam manual</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-foldbeam.core">
<span id="core-functionality"></span><h2>Core functionality<a class="headerlink" href="#module-foldbeam.core" title="Permalink to this headline">¶</a></h2>
<p>Mechanisms for converting axis-aligned bounding boxes (<a class="reference internal" href="#foldbeam.core.Envelope" title="foldbeam.core.Envelope"><tt class="xref py py-class docutils literal"><span class="pre">Envelope</span></tt></a>) and polygonal boundaries
(<a class="reference internal" href="#foldbeam.core.Boundary" title="foldbeam.core.Boundary"><tt class="xref py py-class docutils literal"><span class="pre">Boundary</span></tt></a>) from one spatial reference system to another. It is used internally to convert the regions
represented by tiles between spatial references.</p>
<dl class="class">
<dt id="foldbeam.core.Boundary">
<em class="property">class </em><tt class="descclassname">foldbeam.core.</tt><tt class="descname">Boundary</tt><big>(</big><em>geometry</em><big>)</big><a class="headerlink" href="#foldbeam.core.Boundary" title="Permalink to this definition">¶</a></dt>
<dd><p>A polygon defining an enclosing boundary for a region. A boundary <em>always</em> has an associated spatial reference.</p>
<p>Generally you&#8217;ll want to use the <a class="reference internal" href="#foldbeam.core.boundary_from_envelope" title="foldbeam.core.boundary_from_envelope"><tt class="xref py py-func docutils literal"><span class="pre">boundary_from_envelope()</span></tt></a> function to construct a boundary unless you have
specific needs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>geometry</strong> (<tt class="xref py py-class docutils literal"><span class="pre">ogr.Geometry</span></tt> with polygon type) &#8211; boundary geometry</td>
</tr>
</tbody>
</table>
<dl class="data">
<dt id="foldbeam.core.Boundary.geometry">
<tt class="descname">geometry</tt><a class="headerlink" href="#foldbeam.core.Boundary.geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>An underlying instance of ogr.Geometry which specifies the boundary polygon.</p>
</dd></dl>

<dl class="method">
<dt id="foldbeam.core.Boundary.contains_point">
<tt class="descname">contains_point</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#foldbeam.core.Boundary.contains_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to test if a point is contained within this boundary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>float</em>) &#8211; the point&#8217;s x-co-ordinate</li>
<li><strong>y</strong> (<em>float</em>) &#8211; the point&#8217;s y-co-ordinate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.core.Boundary.envelope">
<tt class="descname">envelope</tt><a class="headerlink" href="#foldbeam.core.Boundary.envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the bounding axis-aligned envelope which entirely contains this boundary.</p>
<p>Since a boundary is an arbitrary polygon and an envelope is only an axis-aligned bounding box, the returned
envelope will also contain point not within this boundary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#foldbeam.core.Envelope" title="foldbeam.core.Envelope"><tt class="xref py py-class docutils literal"><span class="pre">Envelope</span></tt></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="foldbeam.core.Boundary.transform_to">
<tt class="descname">transform_to</tt><big>(</big><em>other_spatial_reference</em>, <em>src_seg_len=None</em>, <em>dst_seg_len=None</em><big>)</big><a class="headerlink" href="#foldbeam.core.Boundary.transform_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform this boundary into another spatial reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>other_spatial_reference</strong> (<tt class="xref py py-class docutils literal"><span class="pre">osr.SpatialReference</span></tt>) &#8211; the destination spatial reference</li>
<li><strong>src_seg_len</strong> (<em>float or None</em>) &#8211; the maximum length of a boundary segment in the source spatial reference</li>
<li><strong>dst_seg_len</strong> (<em>float or None</em>) &#8211; the maximum length of a boundary segment in the detination spatial reference</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#foldbeam.core.Boundary" title="foldbeam.core.Boundary"><tt class="xref py py-class docutils literal"><span class="pre">Boundary</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
<p>This is a subtle function. The boundary is defined as a polygon of linear segments but, of course, lines do not
necessarily map to lines in a projection. This function may optionally segmentise the boundary before
transforming and simplify it afterwards.</p>
<p>If <em>src_seg_len</em> is not None, it specifies the maximum length in the source spatial reference for boundary
segments. If known, set this to the approximate length of a pixel in the source spatial reference.</p>
<p>If <em>dst_seg_len</em> is not None, it specifies the maximum length in the destination spatial reference used to
simplify the transformed boundary. If known, set this to the approximate length of a pixel in the destination
spatial reference.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="foldbeam.core.Envelope">
<em class="property">class </em><tt class="descclassname">foldbeam.core.</tt><tt class="descname">Envelope</tt><big>(</big><em>left</em>, <em>right</em>, <em>top</em>, <em>bottom</em>, <em>spatial_reference</em><big>)</big><a class="headerlink" href="#foldbeam.core.Envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>An axis-aligned bounding box in a particular spatial reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>left</strong> &#8211; the left-most x co-ordinate</li>
<li><strong>right</strong> &#8211; the right-most x co-ordinate</li>
<li><strong>top</strong> &#8211; the top-most y co-ordinate</li>
<li><strong>bottom</strong> &#8211; the bottom-most y co-ordinate</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="foldbeam.core.Envelope.bottom_right">
<tt class="descname">bottom_right</tt><big>(</big><big>)</big><a class="headerlink" href="#foldbeam.core.Envelope.bottom_right" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the bottom-right point for this envelope.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">TileStache.Geography.Point</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="foldbeam.core.Envelope.offset">
<tt class="descname">offset</tt><big>(</big><big>)</big><a class="headerlink" href="#foldbeam.core.Envelope.offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple giving the offset from the top-left corner to the bottom right.</p>
</dd></dl>

<dl class="method">
<dt id="foldbeam.core.Envelope.size">
<tt class="descname">size</tt><big>(</big><big>)</big><a class="headerlink" href="#foldbeam.core.Envelope.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple giving the <em>absolute</em> offset from the top-left corner to the bottom right.</p>
</dd></dl>

<dl class="method">
<dt id="foldbeam.core.Envelope.top_left">
<tt class="descname">top_left</tt><big>(</big><big>)</big><a class="headerlink" href="#foldbeam.core.Envelope.top_left" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the top-left point for this envelope.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">TileStache.Geography.Point</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="foldbeam.core.Envelope.transform_to">
<tt class="descname">transform_to</tt><big>(</big><em>other_spatial_reference</em>, <em>src_seg_len=None</em>, <em>dst_seg_len=None</em><big>)</big><a class="headerlink" href="#foldbeam.core.Envelope.transform_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a envelope which contains this envelope in a target spatial reference.</p>
<p>This is a convenience function which converts the envelope into a rectangular boundary, transforms it and
returns the envelope of the resulting boundary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>other_spatial_reference</strong> (<tt class="xref py py-class docutils literal"><span class="pre">osr.SpatialReference</span></tt>) &#8211; the destination spatial reference</li>
<li><strong>src_seg_len</strong> (<em>float or None</em>) &#8211; the maximum length of a boundary segment in the source spatial reference</li>
<li><strong>dst_seg_len</strong> (<em>float or None</em>) &#8211; the maximum length of a boundary segment in the detination spatial reference</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#foldbeam.core.Envelope" title="foldbeam.core.Envelope"><tt class="xref py py-class docutils literal"><span class="pre">Envelope</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="foldbeam.core.ProjectionError">
<em class="property">exception </em><tt class="descclassname">foldbeam.core.</tt><tt class="descname">ProjectionError</tt><big>(</big><em>message</em><big>)</big><a class="headerlink" href="#foldbeam.core.ProjectionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Error raised when projection from one spatial reference to another has failed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>message</strong> (<em>str</em>) &#8211; a description of the error</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="foldbeam.core.boundary_from_envelope">
<tt class="descclassname">foldbeam.core.</tt><tt class="descname">boundary_from_envelope</tt><big>(</big><em>envelope</em><big>)</big><a class="headerlink" href="#foldbeam.core.boundary_from_envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#foldbeam.core.Boundary" title="foldbeam.core.Boundary"><tt class="xref py py-class docutils literal"><span class="pre">Boundary</span></tt></a> from an <a class="reference internal" href="#foldbeam.core.Envelope" title="foldbeam.core.Envelope"><tt class="xref py py-class docutils literal"><span class="pre">Envelope</span></tt></a>. The boundary is the bounding box which encloses
the envelope.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>envelope</strong> (<a class="reference internal" href="#foldbeam.core.Envelope" title="foldbeam.core.Envelope"><tt class="xref py py-class docutils literal"><span class="pre">Envelope</span></tt></a>) &#8211; the envelope to convert into a boundary</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-foldbeam.geometry">
<span id="geometry-manipulation-and-querying"></span><h2>Geometry manipulation and querying<a class="headerlink" href="#module-foldbeam.geometry" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="foldbeam.geometry.IterableGeometry">
<em class="property">class </em><tt class="descclassname">foldbeam.geometry.</tt><tt class="descname">IterableGeometry</tt><big>(</big><em>geom=None</em><big>)</big><a class="headerlink" href="#foldbeam.geometry.IterableGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>An object suitable for rendering with Geometry which simply stores an iterable of shapely geometry
objects.</p>
<dl class="attribute">
<dt id="foldbeam.geometry.IterableGeometry.geom">
<tt class="descname">geom</tt><a class="headerlink" href="#foldbeam.geometry.IterableGeometry.geom" title="Permalink to this definition">¶</a></dt>
<dd><p>The iterable of shapely geometry objects.</p>
</dd></dl>

<dl class="method">
<dt id="foldbeam.geometry.IterableGeometry.within">
<tt class="descname">within</tt><big>(</big><em>boundary</em>, <em>spatial_reference=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#foldbeam.geometry.IterableGeometry.within" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <em>all</em> of <tt class="xref py py-obj docutils literal"><span class="pre">self.geom</span></tt> or an empty list if it is <cite>None</cite>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-foldbeam.bucket">
<span id="storing-geographic-data-sets"></span><h2>Storing geographic data sets<a class="headerlink" href="#module-foldbeam.bucket" title="Permalink to this headline">¶</a></h2>
<p>Defines a mechanism for persistent storage of geographic data sets in a way which allows for progressive update of
information such as extent and spatial reference.</p>
<dl class="exception">
<dt id="foldbeam.bucket.BadFileNameError">
<em class="property">exception </em><tt class="descclassname">foldbeam.bucket.</tt><tt class="descname">BadFileNameError</tt><a class="headerlink" href="#foldbeam.bucket.BadFileNameError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when one attempts to use a bad file name in a bucket. A bad file name is one which contains path
separators and other &#8216;special&#8217; characters in it.</p>
</dd></dl>

<dl class="class">
<dt id="foldbeam.bucket.Bucket">
<em class="property">class </em><tt class="descclassname">foldbeam.bucket.</tt><tt class="descname">Bucket</tt><big>(</big><em>storage_dir</em><big>)</big><a class="headerlink" href="#foldbeam.bucket.Bucket" title="Permalink to this definition">¶</a></dt>
<dd><p>A bucket is a single unit of data storage corresponding with, usually, a single data source file. For example
this might be a single shapefile or a single raster. This single file is called the &#8216;primary file&#8217;. There may be
other files associated with the file. For example, a .SHP file may have an associated .PRJ, .SHX and .DBF file.</p>
<p>A bucket is similar to a single directory with the restriction that there may be no sub-directories. Files are added
to the bucket via the <a class="reference internal" href="#foldbeam.bucket.Bucket.add" title="foldbeam.bucket.Bucket.add"><tt class="xref py py-meth docutils literal"><span class="pre">add()</span></tt></a> method. The first file added becomes the &#8216;primary file&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>storage_dir</strong> (<em>str</em>) &#8211; a pathname to the directory files within this bucket are stored</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="foldbeam.bucket.Bucket.add">
<tt class="descname">add</tt><big>(</big><em>name</em>, <em>fobj</em><big>)</big><a class="headerlink" href="#foldbeam.bucket.Bucket.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a file named <cite>name</cite> to the bucket reading its contents from the file-like object <cite>fobj</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Raises BadFileNameError:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">When <cite>name</cite> is not a raw file name but has, e.g., a directory separator.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.bucket.Bucket.cache_key">
<tt class="descname">cache_key</tt><a class="headerlink" href="#foldbeam.bucket.Bucket.cache_key" title="Permalink to this definition">¶</a></dt>
<dd><p>A string which represents an opaque hash of this bucket which is suitable for use in caches.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.bucket.Bucket.files">
<tt class="descname">files</tt><a class="headerlink" href="#foldbeam.bucket.Bucket.files" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of files currently in this bucket.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.bucket.Bucket.layers">
<tt class="descname">layers</tt><a class="headerlink" href="#foldbeam.bucket.Bucket.layers" title="Permalink to this definition">¶</a></dt>
<dd><p>A read only sequence of layers within this bucket. Each element is an object exposing the <a class="reference internal" href="#foldbeam.bucket.Layer" title="foldbeam.bucket.Layer"><tt class="xref py py-class docutils literal"><span class="pre">Layer</span></tt></a>
interface. If the files within the bucket cannot yet be interpreted as a geographic data set then this attribute
is an empty sequence.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.bucket.Bucket.primary_file_name">
<tt class="descname">primary_file_name</tt><a class="headerlink" href="#foldbeam.bucket.Bucket.primary_file_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The file name for the &#8216;primary&#8217; file in the bucket. It is this file from which data is loaded. Other files
within the bucket should be auxiliary to this file. (E.g. they should contain projection information.)</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.bucket.Bucket.repo">
<tt class="descname">repo</tt><a class="headerlink" href="#foldbeam.bucket.Bucket.repo" title="Permalink to this definition">¶</a></dt>
<dd><p>A <tt class="xref py py-class docutils literal"><span class="pre">git.Repo</span></tt> object representing the wrapped git repository for this bucket.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="foldbeam.bucket.Layer">
<em class="property">class </em><tt class="descclassname">foldbeam.bucket.</tt><tt class="descname">Layer</tt><a class="headerlink" href="#foldbeam.bucket.Layer" title="Permalink to this definition">¶</a></dt>
<dd><p>An interface for objects returned as layers within a bucket.</p>
<dl class="attribute">
<dt id="foldbeam.bucket.Layer.name">
<tt class="descname">name</tt><a class="headerlink" href="#foldbeam.bucket.Layer.name" title="Permalink to this definition">¶</a></dt>
<dd><p>A human-readable name for the layer.</p>
</dd></dl>

<dl class="method">
<dt id="foldbeam.bucket.Layer.render_to_cairo_context">
<tt class="descname">render_to_cairo_context</tt><big>(</big><em>ctx</em>, <em>srs</em>, <em>tile_box</em>, <em>tile_size</em><big>)</big><a class="headerlink" href="#foldbeam.bucket.Layer.render_to_cairo_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Cairo ImageSurface representation of this layer for a particular spatial reference, tile extent and tile
width/height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ctx</strong> &#8211; the cairo context to render to</li>
<li><strong>srs</strong> (<tt class="xref py py-class docutils literal"><span class="pre">osgeo.osr.SpatialReference</span></tt>) &#8211; the spatial reference for the tile</li>
<li><strong>tile_box</strong> (<em>tuple of float giving (minx, miny, maxx, maxy)</em>) &#8211; the extent of the tile to render in projection co-ordinates</li>
<li><strong>tile_size</strong> (<em>pair of int giving (width, height)</em>) &#8211; the width and height of the tile to render</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a string containing the encoded PNG.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.bucket.Layer.spatial_reference">
<tt class="descname">spatial_reference</tt><a class="headerlink" href="#foldbeam.bucket.Layer.spatial_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>An instance of <tt class="xref py py-class docutils literal"><span class="pre">osgeo.osr.SpatialReference</span></tt> giving the spatial reference for this layer or <cite>None</cite>
if no such spatial reference is available.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.bucket.Layer.subtype">
<tt class="descname">subtype</tt><a class="headerlink" href="#foldbeam.bucket.Layer.subtype" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="#foldbeam.bucket.Layer.type" title="foldbeam.bucket.Layer.type"><tt class="xref py py-attr docutils literal"><span class="pre">type</span></tt></a> is <tt class="xref py py-attr docutils literal"><span class="pre">Layer.VECTOR_TYPE</span></tt>, this is the subtype of the layer or
<tt class="xref py py-attr docutils literal"><span class="pre">Layer.UNKNOWN_SUBTYPE</span></tt>.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.bucket.Layer.type">
<tt class="descname">type</tt><a class="headerlink" href="#foldbeam.bucket.Layer.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Either <tt class="xref py py-attr docutils literal"><span class="pre">Layer.VECTOR_TYPE</span></tt> or <tt class="xref py py-attr docutils literal"><span class="pre">Layer.RASTER_TYPE</span></tt> depending on whether this layer
is a vector or raster layer.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-foldbeam.renderer">
<span id="rendering"></span><h2>Rendering<a class="headerlink" href="#module-foldbeam.renderer" title="Permalink to this headline">¶</a></h2>
<p>Support for rendering directly to Cairo surfaces for display to the user.</p>
<p>This module also imports all sub-module members as a convenience.</p>
<div class="section" id="module-foldbeam.renderer.base">
<span id="base-functionality"></span><h3>Base functionality<a class="headerlink" href="#module-foldbeam.renderer.base" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="foldbeam.renderer.base.Layers">
<em class="property">class </em><tt class="descclassname">foldbeam.renderer.base.</tt><tt class="descname">Layers</tt><big>(</big><em>layers=None</em><big>)</big><a class="headerlink" href="#foldbeam.renderer.base.Layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Render multiple layers one after another. Note that the layers are rendered in the order they are in the sequence
and so the first-most layer will be the bottom-most in the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>layers</strong> (<em>None or a sequence of renderers</em>) &#8211; the set of layers or <cite>None</cite></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="foldbeam.renderer.base.Layers.layers">
<tt class="descname">layers</tt><a class="headerlink" href="#foldbeam.renderer.base.Layers.layers" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>None</cite> or a sequence of renderers. If <cite>None</cite>, no rendering is performed. Otherwise the renderers are rendered
<cite>in their order within the sequence</cite> one after each other.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="foldbeam.renderer.base.RendererBase">
<em class="property">class </em><tt class="descclassname">foldbeam.renderer.base.</tt><tt class="descname">RendererBase</tt><a class="headerlink" href="#foldbeam.renderer.base.RendererBase" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class for all renderers. A renderer can take a cairo surface and render into it. The surface&#8217;s
user-space co-ordinate system specifies the extent to render. The <tt class="xref py py-meth docutils literal"><span class="pre">render()</span></tt> method optionally takes a
spatial reference allowing implicit transformation of the underlying data if necessary.</p>
<dl class="method">
<dt id="foldbeam.renderer.base.RendererBase.render_callable">
<tt class="descname">render_callable</tt><big>(</big><em>context</em>, <em>spatial_reference=None</em><big>)</big><a class="headerlink" href="#foldbeam.renderer.base.RendererBase.render_callable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a callable which can be called to render the object to the specified cairo context.</p>
<p>Calling this method will not modify the Cairo context but may perform an intensive operation to prepare for
rendering (e.g. a database query). The callable returned from this method will modify the context and, if
possible, should do as little work beyond rendering as possible. It is intended that this method be thread safe
but that the callables returned will be called sequentially to perform the actual rendering.</p>
<p>The user co-ordinates of the cairo context are respected. If you want to render a specific portion of the image,
translate and scale the user co-ordinate system appropriately.</p>
<p>The output context&#8217;s co-ordinate system optionally has a spatial reference associated with it. If this is not
specified, it is assumed that the &#8216;natural&#8217; spatial reference of the renderer object will be used. This is
generally a bad idea; unless you know what you&#8217;re doing always specify the <tt class="xref py py-obj docutils literal"><span class="pre">spatial_reference</span></tt>
parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; the cairo context to render this object to</li>
<li><strong>spatial_reference</strong> (<em>osgeo.osr.SpatialReference or None</em>) &#8211; default None, the spatial reference for the context&#8217;s user co-ordinate system</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="foldbeam.renderer.base.Wrapped">
<em class="property">class </em><tt class="descclassname">foldbeam.renderer.base.</tt><tt class="descname">Wrapped</tt><big>(</big><em>renderer</em>, <em>pre=None</em>, <em>post=None</em><big>)</big><a class="headerlink" href="#foldbeam.renderer.base.Wrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap a renderer with, optionally, a pre- or post-called callable. Each callable is passed the cairo context the
renderer is being called with and it is intended that these should set up the Cairo context appropriately. For
example, they may set the Cairo line width or fill pattern.</p>
<dl class="attribute">
<dt id="foldbeam.renderer.base.Wrapped.renderer">
<tt class="descname">renderer</tt><a class="headerlink" href="#foldbeam.renderer.base.Wrapped.renderer" title="Permalink to this definition">¶</a></dt>
<dd><p>The renderer instance to wrap</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.renderer.base.Wrapped.pre">
<tt class="descname">pre</tt><a class="headerlink" href="#foldbeam.renderer.base.Wrapped.pre" title="Permalink to this definition">¶</a></dt>
<dd><p>The callable to call before the renderer&#8217;s <tt class="xref py py-meth docutils literal"><span class="pre">render()</span></tt> method.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.renderer.base.Wrapped.post">
<tt class="descname">post</tt><a class="headerlink" href="#foldbeam.renderer.base.Wrapped.post" title="Permalink to this definition">¶</a></dt>
<dd><p>The callable to call before the renderer&#8217;s <tt class="xref py py-meth docutils literal"><span class="pre">render()</span></tt> method.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="foldbeam.renderer.base.set_geo_transform">
<tt class="descclassname">foldbeam.renderer.base.</tt><tt class="descname">set_geo_transform</tt><big>(</big><em>context</em>, <em>left</em>, <em>right</em>, <em>top</em>, <em>bottom</em>, <em>device_width</em>, <em>device_height</em><big>)</big><a class="headerlink" href="#foldbeam.renderer.base.set_geo_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a geo transform to a cairo context.</p>
<p>This is a convenience function to make it easy to map a desired output extent onto an output surface. Calling this
with the desired top, left, bottom and right co-ordinates corresponding to the rectangular extent of a surface will
append the appropriate transformation matrix to the cairo context.</p>
<p>If the top-left of the context was (0,0) and the bottom right was (device_width, device_height), after this the
top-left is (left, top) and bottom-right is (right, bottom).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; the cairo context to transform</li>
<li><strong>left</strong> &#8211; the left co-ordinate</li>
<li><strong>right</strong> &#8211; the right co-ordinate</li>
<li><strong>top</strong> &#8211; the top co-ordinate</li>
<li><strong>bottom</strong> &#8211; the bottom co-ordinate</li>
<li><strong>device_width</strong> &#8211; the width of the underlying device</li>
<li><strong>device_height</strong> &#8211; the height of the underlying device</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-foldbeam.renderer.tile_fetcher">
<span id="tiles-from-slippy-maps"></span><h3>Tiles from &#8216;slippy&#8217; maps<a class="headerlink" href="#module-foldbeam.renderer.tile_fetcher" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="foldbeam.renderer.tile_fetcher.TileFetcher">
<em class="property">class </em><tt class="descclassname">foldbeam.renderer.tile_fetcher.</tt><tt class="descname">TileFetcher</tt><big>(</big><em>url_pattern=None</em>, <em>spatial_reference=None</em>, <em>tile_size=None</em>, <em>bounds=None</em>, <em>url_fetcher=None</em><big>)</big><a class="headerlink" href="#foldbeam.renderer.tile_fetcher.TileFetcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Render from slippy map tile URLs.</p>
<p>This is somewhat incomplete at the moment. Given a Google/Bing/OSM-style slippy map tile URL pattern of the form
<tt class="docutils literal"><span class="pre">http://server/path/to/tiles/{zoom}/{x}/{y}.format</span></tt>, this renderer can render the tiles to a Cairo context.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If no spatial reference is specified, it will default to EPSG:3857. Similarly, if no bounds are specified, the
default is to assume the bounds of this projection (x and y being +/- 20037508.34 metres).</p>
</div>
<p>The default URL pattern is <tt class="docutils literal"><span class="pre">http://otile1.mqcdn.com/tiles/1.0.0/osm/{zoom}/{x}/{y}.jpg</span></tt> which will load tiles
from the MapQuest servers.</p>
<p>If the <em>url_fetcher</em> parameter is specified, it is a callable which takes a single string giving a URL as the first
argument and returns a sequence of bytes for the URL contents. It can raise URLFetchError if the resource is not
available. If no fetcher is provided, <a class="reference internal" href="#foldbeam.renderer.tile_fetcher.default_url_fetcher" title="foldbeam.renderer.tile_fetcher.default_url_fetcher"><tt class="xref py py-func docutils literal"><span class="pre">default_url_fetcher()</span></tt></a> is used. The fetcher callable must be
thread-safe.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>url_pattern</strong> (<em>string</em>) &#8211; default is to use MapQuest, a pattern for calculating the URL to load tiles from</li>
<li><strong>spatial_reference</strong> (<em>osgeo.osr.SpatialReference or None</em>) &#8211; default EPSG:3857, the native spatial reference for the tiles</li>
<li><strong>tile_size</strong> (<em>tuple of integer or None</em>) &#8211; default (256, 256), the width and height of one tile in pixels</li>
<li><strong>bounds</strong> (<em>tuple of float or None</em>) &#8211; default as noted above, the left, right, top and bottom boundary of the projection</li>
<li><strong>url_fetcher</strong> (<em>callable or None</em>) &#8211; which callable to use for URL fetching</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="exception">
<dt id="foldbeam.renderer.tile_fetcher.URLFetchError">
<em class="property">exception </em><tt class="descclassname">foldbeam.renderer.tile_fetcher.</tt><tt class="descname">URLFetchError</tt><a class="headerlink" href="#foldbeam.renderer.tile_fetcher.URLFetchError" title="Permalink to this definition">¶</a></dt>
<dd><p>An error raised by a custom URL fetchber for TileFetcher if the URL could not be fetchbed.</p>
</dd></dl>

<dl class="function">
<dt id="foldbeam.renderer.tile_fetcher.default_url_fetcher">
<tt class="descclassname">foldbeam.renderer.tile_fetcher.</tt><tt class="descname">default_url_fetcher</tt><big>(</big><em>url</em><big>)</big><a class="headerlink" href="#foldbeam.renderer.tile_fetcher.default_url_fetcher" title="Permalink to this definition">¶</a></dt>
<dd><p>The default URL fetcher to use in <a class="reference internal" href="#foldbeam.renderer.tile_fetcher.TileFetcher" title="foldbeam.renderer.tile_fetcher.TileFetcher"><tt class="xref py py-class docutils literal"><span class="pre">TileFetcher</span></tt></a>. If there is an error fetching the URL a URLFetchError
is raised.</p>
</dd></dl>

</div>
<div class="section" id="module-foldbeam.renderer.geometry">
<span id="vector-geometry"></span><h3>Vector geometry<a class="headerlink" href="#module-foldbeam.renderer.geometry" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="foldbeam.renderer.geometry.Geometry">
<em class="property">class </em><tt class="descclassname">foldbeam.renderer.geometry.</tt><tt class="descname">Geometry</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#foldbeam.renderer.geometry.Geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Render shapely geometric shapes into a context.</p>
<p>If keyword arguments are supplied, set the attributes listed below.</p>
<dl class="attribute">
<dt id="foldbeam.renderer.geometry.Geometry.geom">
<tt class="descname">geom</tt><a class="headerlink" href="#foldbeam.renderer.geometry.Geometry.geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Default None. An object which yields a set of geometry to render. For example,
<a class="reference internal" href="#foldbeam.geometry.IterableGeometry" title="foldbeam.geometry.IterableGeometry"><tt class="xref py py-class docutils literal"><span class="pre">foldbeam.geometry.IterableGeometry</span></tt></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.renderer.geometry.Geometry.marker_radius">
<tt class="descname">marker_radius</tt><a class="headerlink" href="#foldbeam.renderer.geometry.Geometry.marker_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Default 5. The radius, in projection co-ordinates, of the point marker.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.renderer.geometry.Geometry.stroke">
<tt class="descname">stroke</tt><a class="headerlink" href="#foldbeam.renderer.geometry.Geometry.stroke" title="Permalink to this definition">¶</a></dt>
<dd><p>Default True. If True, call &#8216;stroke()&#8217; to draw the outline of geometry.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.renderer.geometry.Geometry.fill">
<tt class="descname">fill</tt><a class="headerlink" href="#foldbeam.renderer.geometry.Geometry.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Default False. If True, call &#8216;fill()&#8217; to fill the geometry. If both <a class="reference internal" href="#foldbeam.renderer.geometry.Geometry.fill" title="foldbeam.renderer.geometry.Geometry.fill"><tt class="xref py py-attr docutils literal"><span class="pre">fill</span></tt></a> and <a class="reference internal" href="#foldbeam.renderer.geometry.Geometry.stroke" title="foldbeam.renderer.geometry.Geometry.stroke"><tt class="xref py py-attr docutils literal"><span class="pre">stroke</span></tt></a> are
True, then filling happens first.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.renderer.geometry.Geometry.prepare_stroke">
<tt class="descname">prepare_stroke</tt><a class="headerlink" href="#foldbeam.renderer.geometry.Geometry.prepare_stroke" title="Permalink to this definition">¶</a></dt>
<dd><p>Default <cite>None</cite>. If not <cite>None</cite>, a callable which is called with a single argument of the cairo context to prepare
it for a stroke operation.</p>
</dd></dl>

<dl class="attribute">
<dt id="foldbeam.renderer.geometry.Geometry.prepare_fill">
<tt class="descname">prepare_fill</tt><a class="headerlink" href="#foldbeam.renderer.geometry.Geometry.prepare_fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Default <cite>None</cite>. If not <cite>None</cite>, a callable which is called with a single argument of the cairo context to prepare
it for a fill operation.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-foldbeam.renderer.decorator">
<span id="decorators"></span><h3>Decorators<a class="headerlink" href="#module-foldbeam.renderer.decorator" title="Permalink to this headline">¶</a></h3>
<p>Method decorators suitable for renderers.</p>
<dl class="function">
<dt id="foldbeam.renderer.decorator.reproject_from_native_spatial_reference">
<tt class="descclassname">foldbeam.renderer.decorator.</tt><tt class="descname">reproject_from_native_spatial_reference</tt><big>(</big><em>f</em><big>)</big><a class="headerlink" href="#foldbeam.renderer.decorator.reproject_from_native_spatial_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap a rendering method by reprojecting rasterised images from a renderer which can handle only one spatial
reference.</p>
<p>The object with the wrapped rendering method <em>must</em> have an attribute called <tt class="xref py py-attr docutils literal"><span class="pre">native_spatial_reference</span></tt>
which is an instance of <tt class="xref py py-class docutils literal"><span class="pre">osgeo.osr.SpatialReference</span></tt> giving the native spatial reference for that renderer.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-foldbeam.goodies">
<span id="other-goodies"></span><h2>Other &#8216;goodies&#8217;<a class="headerlink" href="#module-foldbeam.goodies" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-foldbeam.goodies.tilestache">
<span id="tilestache-integration"></span><h3>TileStache integration<a class="headerlink" href="#module-foldbeam.goodies.tilestache" title="Permalink to this headline">¶</a></h3>
<p>Support for using a renderer as a provider with TileStache for serving slippy map tiles.</p>
<dl class="class">
<dt id="foldbeam.goodies.tilestache.TileStacheProvider">
<em class="property">class </em><tt class="descclassname">foldbeam.goodies.tilestache.</tt><tt class="descname">TileStacheProvider</tt><big>(</big><em>layer</em><big>)</big><a class="headerlink" href="#foldbeam.goodies.tilestache.TileStacheProvider" title="Permalink to this definition">¶</a></dt>
<dd><p>An object suitable for use as a TileStache provider.</p>
<dl class="attribute">
<dt id="foldbeam.goodies.tilestache.TileStacheProvider.renderer">
<tt class="descname">renderer</tt><a class="headerlink" href="#foldbeam.goodies.tilestache.TileStacheProvider.renderer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set this attribute to a renderer instance to use for rendering map tiles.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Reference</a><ul>
<li><a class="reference internal" href="#module-foldbeam.core">Core functionality</a></li>
<li><a class="reference internal" href="#module-foldbeam.geometry">Geometry manipulation and querying</a></li>
<li><a class="reference internal" href="#module-foldbeam.bucket">Storing geographic data sets</a></li>
<li><a class="reference internal" href="#module-foldbeam.renderer">Rendering</a><ul>
<li><a class="reference internal" href="#module-foldbeam.renderer.base">Base functionality</a></li>
<li><a class="reference internal" href="#module-foldbeam.renderer.tile_fetcher">Tiles from &#8216;slippy&#8217; maps</a></li>
<li><a class="reference internal" href="#module-foldbeam.renderer.geometry">Vector geometry</a></li>
<li><a class="reference internal" href="#module-foldbeam.renderer.decorator">Decorators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-foldbeam.goodies">Other &#8216;goodies&#8217;</a><ul>
<li><a class="reference internal" href="#module-foldbeam.goodies.tilestache">TileStache integration</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">The Foldbeam GIS System</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="design.html"
                        title="next chapter">Design notes</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/reference.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="design.html" title="Design notes"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The Foldbeam GIS System"
             >previous</a> |</li>
        <li><a href="index.html">The foldbeam manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Rich Wareham.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>